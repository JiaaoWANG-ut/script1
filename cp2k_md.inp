#Generated by Jiaao_Wang_UTAUSTIN_Henkelman_Group
&GLOBAL
  PROJECT MD-tempelate
  PRINT_LEVEL MEDIUM
  RUN_TYPE MD
&END GLOBAL

&FORCE_EVAL
  METHOD Quickstep
  STRESS_TENSOR ANALYTICAL
  &PRINT
    &FORCES ON
    &END FORCES
    &STRESS_TENSOR ON
    &END STRESS_TENSOR
  &END PRINT
  &SUBSYS
  @INCLUDE input.structure
  @INCLUDE element.pot
  &END SUBSYS

  &DFT
    BASIS_SET_FILE_NAME  BASIS_MOLOPT
    POTENTIAL_FILE_NAME  GTH_POTENTIALS
#   WFN_RESTART_FILE_NAME Layer-RESTART.wfn
   # CHARGE    0 #Net charge
    #MULTIPLICITY    1 #Spin multiplicity
    UKS
    &QS
      #METHOD GPW
      EPS_DEFAULT 1E-10 #This is default. Set all EPS_xxx to values such that the energy will be correct up to this value
      EXTRAPOLATION ASPC #Extrapolation for wavefunction during e.g. MD. ASPC is default, PS also be used
      EXTRAPOLATION_ORDER 3 #Order for PS or ASPC extrapolation. 3 is default
    &END QS
    &POISSON
      PERIODIC XYZ #Direction(s) of PBC for calculating electrostatics
      PSOLVER PERIODIC #The way to solve Poisson equation
    &END POISSON
    &XC
      &XC_FUNCTIONAL PBE
      &END XC_FUNCTIONAL
      &VDW_POTENTIAL
        POTENTIAL_TYPE PAIR_POTENTIAL
        &PAIR_POTENTIAL
          PARAMETER_FILE_NAME dftd3.dat
          TYPE DFTD3
          REFERENCE_FUNCTIONAL PBE
        &END PAIR_POTENTIAL
      &END VDW_POTENTIAL
    &END XC
    &MGRID
      CUTOFF 400
      REL_CUTOFF 55
    &END MGRID
    &SCF
      MAX_SCF 150 #Should be set to a small value (e.g. 30) if enabling outer SCF
      MAX_SCF_HIST 3

      &OT
        PRECONDITIONER FULL_KINETIC #FULL_SINGLE_INVERSE is also worth to try. FULL_ALL is better but quite expensive for large system
        MINIMIZER DIIS #CG is worth to consider in difficult cases
        LINESEARCH 2PNT #1D line search algorithm for CG. 2PNT is default, 3PNT is better but more costly. GOLD is best but very expensive
      &END OT

      &PRINT
        &RESTART #Use "&RESTART OFF" can prevent generating wfn file
          BACKUP_COPIES 0 #Maximum number of backup copies of wfn file
        &END RESTART
      &END PRINT
    &END SCF
  &END DFT
&END FORCE_EVAL

&MOTION
  &MD
    ENSEMBLE LANGEVIN
    STEPS 30000     
    TIMESTEP 1 #fs. Decrease it properly for high temperature simulation
    TEMPERATURE 1200 #Initial and maintained temperature (K)
    &LANGEVIN
      GAMMA 0.01
      NOISY_GAMMA 2.2E-4
    &END LANGEVIN
    &THERMAL_REGION
      DO_LANGEVIN_DEFAULT F     
      &PRINT
        &LANGEVIN_REGIONS
        &END LANGEVIN_REGIONS
      &END PRINT
    &END THERMAL_REGION
    #&THERMOSTAT
    # TYPE GLE
    #&END THERMOSTAT
  &END MD

  &PRINT
    &FORCES
      &EACH
        MD 1
      &END EACH
    &END FORCES
    &TRAJECTORY
      &EACH
        MD     1 #Output frequency of geometry
      &END EACH
      FORMAT xyz
    &END TRAJECTORY
    &CELL
      &EACH
        MD     1 #Output frequency of CELL
      &END EACH
    &END CELL
    &VELOCITIES
      &EACH
       MD     1 #Output frequency of velocity
      &END EACH
    &END VELOCITIES
    &RESTART
      BACKUP_COPIES 0 #Maximum number of backing up restart file
      &EACH
        MD 1 #Frequency of updating last restart file
      &END EACH
    &END RESTART
  &END PRINT
&END MOTION
